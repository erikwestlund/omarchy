# Caddy reverse proxy for local development
# Managed by Ansible - do not edit directly

# Global options
{
	# Disable HTTPS for local .test domains
	auto_https off
	# Listen on port 80
	http_port 80
}

{% for site in dev_sites %}
# {{ site.domain }}
http://{{ site.domain }}{% if site.wildcard | default(false) %}, http://*.{{ site.domain }}{% endif %} {
	reverse_proxy localhost:{{ site.port }}
}

{% endfor %}
{% for svc in dev_service_proxies | default([]) %}
# {{ svc.prefix }}.*.{{ svc.tld }} -> localhost:{{ svc.port }}
http://{{ svc.prefix }}.*.{{ svc.tld }} {
	reverse_proxy localhost:{{ svc.port }}
}

{% endfor %}
