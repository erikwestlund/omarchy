#!/usr/bin/env bash
# Smart close:
# - Teams/Outlook: use normal window close (same as Super+W / killactive)
# - Everything else: hard kill the active window process

PROTECTED_CLASSES="teams|outlook"

active=$(hyprctl activewindow -j)
class=$(echo "$active" | jq -r '.class // ""')
pid=$(echo "$active" | jq -r '.pid // ""')

if echo "$class" | grep -qiE "$PROTECTED_CLASSES"; then
    # Match Super+W behavior for Teams/Outlook only
    hyprctl dispatch killactive
else
    # Kill normally
    if [[ -n "$pid" && "$pid" != "null" ]]; then
        kill -9 "$pid"
    fi
fi
