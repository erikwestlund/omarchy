#!/usr/bin/env bash
# Smart close:
# - Teams/Outlook: hide to special workspace to preserve sessions
# - Everything else: normal close (killactive)

PROTECTED_CLASSES="teams|outlook"

active=$(hyprctl activewindow -j)
class=$(echo "$active" | jq -r '.class // ""')

if echo "$class" | grep -qiE "$PROTECTED_CLASSES"; then
    # Hide instead of closing to preserve auth/session state
    hyprctl dispatch movetoworkspacesilent special:hidden
else
    # Normal close behavior
    hyprctl dispatch killactive
fi
