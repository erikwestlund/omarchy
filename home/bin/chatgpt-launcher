#!/usr/bin/env bash
# Launch chatgpt in isolated Chromium profile with 1Password
# Always opens a new window without stealing focus

PROFILE="$HOME/.config/chromium-chatgpt"
URL="https://chatgpt.com"

# Find 1Password extension (latest version)
ONEPASS_EXT=$(find ~/.config/chromium/Default/Extensions/aeblfdkhhhdcdjpifhhbdiojplfjncoa -maxdepth 1 -mindepth 1 -type d 2>/dev/null | head -1)

if [[ -n "$ONEPASS_EXT" ]]; then
    exec setsid uwsm-app -- chromium --user-data-dir="$PROFILE" --load-extension="$ONEPASS_EXT" --disable-popup-blocking --app="$URL"
else
    exec setsid uwsm-app -- chromium --user-data-dir="$PROFILE" --disable-popup-blocking --app="$URL"
fi
